var barbaraJs=angular.module("Barbara-Js",["ngSanitize"]);barbaraJs.factory("$request",["$http",function(a){var e=function(a){var e=null;return e=""===a.statusText?"Não foi possivel realizar esta requisição! Código de erro "+a.status:a.statusText,{code:a.status,message:e}},t=function(a,e){return angular.isDefined(a.code)||(a.code=e.status),angular.isDefined(a.message)||(a.message=e.statusText),a},i=function(a,i,n,s){if(angular.isDefined(i.callbackLoad)&&i.callbackLoad.loaded(),i.checkMeta)if(angular.isObject(a.data))if(angular.isObject(a.data.meta)){var r=angular.isDefined(a.data.meta.code)?parseInt(a.data.meta.code):400;a.data.meta.code=r;o=t(a.data.meta,a);r>=200&&r<=299?n(a.data.data,o,a):s(o,a.status,a),angular.forEach(i.callback,function(e){this.code==e.metaCode&&e.callback(a.data.data,this,a)},o)}else{var o=t({},a);angular.forEach(i.callback,function(e){this.code==e.metaCode&&e.callback(o,a.status,a)},o),s(o,a.status,a)}else s(e(a),a.status,a);else n(a)},n=function(a,i,n){angular.isDefined(i.callbackLoad)&&i.callbackLoad.loaded(),angular.isObject(a.data)||(a.data={});var s=angular.isObject(a.data.meta)?t(a.data.meta,a):e(a);angular.forEach(i.callback,function(e){this.code==e.metaCode&&e.callback(s,a.status,a)},s),n(s,a.status,a)};return{parameter:{},urlencoded:!1,data:{},headers:{"X-Requested-With":"XMLHttpRequest"},method:"GET",url:void 0,callback:[],callbackLoad:void 0,checkMeta:!0,config:{},urlEncoded:function(){return this.addHeaders({"Content-Type":"application/x-www-form-urlencoded"}),this.urlencoded=function(a){var e=[];for(var t in a)e.push(encodeURIComponent(t)+"="+encodeURIComponent(a[t]));return e.join("&")},this},checkResponse:function(a){return this.checkMeta=!!a,this},removeAjaxHeader:function(){return angular.isDefined(this.headers["X-Requested-With"])&&delete this.headers["X-Requested-With"],this},addCallback:function(a,e){return angular.isNumber(a)&&angular.isFunction(e)&&this.callback.push({metaCode:a,callback:e}),this},addMethod:function(a){return this.method=angular.isString(a)?a:"GET",this},addData:function(a){return this.data=angular.isObject(a)?a:{},this},addParams:function(a){return this.parameter=angular.isObject(a)?a:{},this},addHeaders:function(a){return angular.isObject(a)&&(this.headers=angular.extend(this.headers,a)),this},addUrl:function(a){return this.url=angular.isString(a)?a:this.url,this},load:function(a,e){if(angular.isObject(a)&&angular.isFunction(a.loading)&&angular.isFunction(a.loaded)&&(e=a.loaded,a=a.loading),!angular.isFunction(a)||!angular.isFunction(e))throw"Não foi possível adicionar as funções de carregamento!";return this.callbackLoad={onLoading:a,loaded:e},this},get:function(a){return this.addUrl(a),this.addMethod("GET"),angular.copy(this)},post:function(a){return this.addUrl(a),this.addMethod("POST"),angular.copy(this)},put:function(a){return this.addUrl(a),this.addMethod("PUT"),angular.copy(this)},delete:function(a){return this.addUrl(a),this.addMethod("DELETE"),angular.copy(this)},jsonp:function(a){return this.addUrl(a),this.addMethod("JSONP"),angular.copy(this)},send:function(e,t){var s=this;if(!angular.isFunction(e))throw"É necessário definir um callback de sucesso no $request.send()!";if(angular.isFunction(t)||(t=function(){}),!angular.isDefined(s.url))throw"Nenhum URL foi definido!";switch(angular.isDefined(s.callbackLoad)&&s.callbackLoad.onLoading(),s.config.headers=s.headers,s.urlencoded&&(s.config.transformRequest=s.urlencoded),s.method){case"GET":angular.extend(s.parameter,s.data),s.config.params=s.parameter,a.get(s.url,s.config).then(function(a){i(a,s,e,t)},function(a){n(a,s,t)});break;case"POST":s.config.params=s.parameter,a.post(s.url,s.data,s.config).then(function(a){i(a,s,e,t)},function(a){n(a,s,t)});break;case"PUT":s.config.params=s.parameter,a.put(s.url,s.data,s.config).then(function(a){i(a,s,e,t)},function(a){n(a,s,t)});break;case"DELETE":s.config.params=s.parameter,s.config.data=s.data,a.delete(s.url,s.config).then(function(a){i(a,s,e,t)},function(a){n(a,s,t)});break;case"JSONP":s.config.params=s.parameter,s.config.data=s.data,s.config.params.callback="JSON_CALLBACK",a.jsonp(s.url,s.config).then(function(a){i(a,s,e,t)},function(a){n(a,s,t)});break;default:s.config.params=s.parameter,s.config.data=s.data,s.config.method=s.method,s.config.url=s.url,a(s.config).then(function(a){i(a,s,e,t)},function(a){n(a,s,t)})}}}}]),barbaraJs.factory("bootstrap",function(){return{alert:function(){return{show:!1,changeShow:function(a){this.show=angular.isDefined(a)?a:!this.show},type:void 0,changeType:function(a){this.type=angular.isString(a)?a:this.type},title:void 0,changeTitle:function(a){this.title=angular.isString(a)?a:this.title},message:void 0,changeMessage:function(a){this.message=angular.isString(a)?a:this.message},responseSuccess:function(a){angular.isString(a)&&(this.changeTitle("Sucesso!"),this.changeType("success"),this.changeMessage(a),this.changeShow(!0))},responseError:function(a){if(this.changeTitle("Algo não ocorreu bem!"),this.changeType("danger"),angular.isDefined(a.error_message)&&angular.isString(a.error_message))this.changeMessage(a.error_message),this.changeType("warning");else if(angular.isDefined(a.error_message)&&angular.isArray(a.error_message)){e=a.error_message;this.changeTitle(e.shift()),this.changeMessage(e.join("<br>")),this.changeType("warning")}else if(angular.isDefined(a.message)&&angular.isString(a.message))this.changeMessage(a.message),this.changeType("warning");else if(angular.isDefined(a.message)&&angular.isArray(a.message)){var e=a.message;this.changeTitle(e.shift()),this.changeMessage(e.join("<br>")),this.changeType("warning")}else this.changeMessage("Ocorreu um erro na requisição!");this.changeShow(!0)}}},loading:function(){return{show:!1,changeShow:function(a){this.show=angular.isDefined(a)?a:!this.show},message:"Carregando...",changeMessage:function(a){this.message=angular.isString(a)?a:this.message},onLoading:function(a){this.message=angular.isString(a)?a:this.message,this.changeShow(!0)},loaded:function(){this.changeShow(!1)},getRequestLoad:function(a){var e=this;return{loading:function(){e.onLoading(a)},loaded:function(){e.loaded()}}}}},pagination:function(){return{pages:0,currentPage:1,pagination:[],callback:void 0,changePageCallback:function(a){this.callback=angular.isFunction(a)?a:this.callback},changePages:function(a){this.pages=angular.isNumber(a)?a:this.pages,this.processPagination()},changeCurrentPage:function(a){return this.currentPage=angular.isNumber(a)&&a>0&&a<=this.pages?a:this.currentPage,a==this.currentPage},processPagination:function(){0!=this.pages&&(this.pagination=[],this.pagination.push({item:1,role:this.pages>0}),this.pagination.push({item:this.pages<=9?2:this.currentPage<=5?2:void 0,role:this.pages>2}),this.pagination.push({item:this.pages<=9||this.currentPage<=5?3:this.currentPage+5>=this.pages?this.pages-6:this.currentPage-2,role:this.pages>3}),this.pagination.push({item:this.pages<=9||this.currentPage<=5?4:this.currentPage+5>=this.pages?this.pages-5:this.currentPage-1,role:this.pages>4}),this.pagination.push({item:this.pages<=9||this.currentPage<=5?5:this.currentPage+5>=this.pages?this.pages-4:this.currentPage,role:this.pages>5}),this.pagination.push({item:this.pages<=9||this.currentPage<=5?6:this.currentPage+5>=this.pages?this.pages-3:this.currentPage+1,role:this.pages>6}),this.pagination.push({item:this.pages<=9||this.currentPage<=5?7:this.currentPage+5>=this.pages?this.pages-2:this.currentPage+2,role:this.pages>7}),this.pagination.push({item:this.pages<=9?8:10==this.pages&&5==this.currentPage?void 0:this.currentPage+5>=this.pages?this.pages-1:void 0,role:this.pages>8}),this.pagination.push({item:this.pages,role:this.pages>1}),angular.forEach(this.pagination,function(a){a.class={active:this.currentPage==a.item,disabled:angular.isUndefined(a.item)}},this))},clickAction:function(a){angular.isDefined(a)&&this.changeCurrentPage(a)&&(angular.isFunction(this.callback)?(this.changePages(0),this.callback(this)):this.processPagination())}}}}}),barbaraJs.directive("alertBootstrap",function(){return{restrict:"A",template:"<div class='alert alert-{{alert.type}} alert-dismissible' role='alert' ng-if='alert.show'><button type='button' class='close' ng-click='alert.changeShow()'><span aria-hidden='true'>&times;</span></button><strong>{{alert.title}}</strong> <p ng-bind-html='alert.message'></p></div>"}}),barbaraJs.directive("loadingBootstrap",function(){return{restrict:"A",template:"<div class='progress' ng-if='loading.show'> <div class='progress-bar progress-bar-striped active' role='progressbar' style='width: 100%'><i class='glyphicon glyphicon-refresh spinning'></i> <strong ng-bind-html='loading.message'></strong></div></div>"}}),barbaraJs.directive("paginationBootstrap",function(){return{restrict:"A",template:"<nav ng-if='pagination.pages > 0'> <ul class='pagination'> <li ng-repeat='page in pagination.pagination' ng-if='page.role' ng-class='page.class'> <a href='' ng-click='pagination.clickAction(page.item)'>{{page.item ? page.item : '...'}}</a> </li></ul> </nav>"}}),barbaraJs.filter("timeago",function(){return function(a){var e=(new Date).getTime();if(!a)return"indefinido";if(angular.isDate(a)?a=a.getTime():angular.isNumber(a)?a=new Date(1e3*a).getTime():angular.isString(a)&&(a=new Date(a).getTime()),!angular.isNumber(a))return"Data invalida";var t=Math.abs((e-a)/1e3),i=[];return i=t<=60?["","agora"]:t<3600?[Math.round(Math.abs(t/60)),"m"]:t<86400?[Math.round(Math.abs(t/3600)),"h"]:t<604800?[Math.round(Math.abs(t/86400)),"d"]:t<31449600?[Math.round(Math.abs(t/604800)),"sm"]:t<315569260?[Math.round(Math.abs(t/31556926)),"a"]:["","..."],i=i.join(""),a<=e?"há "+i:i}}),barbaraJs.filter("cuttext",function(){return function(a,e,t,i){if(!a||!angular.isString(a))return"";if(!t||!angular.isNumber(t))return a;if(t=parseInt(t,10),a.length<=t||e)return a;var n=(a=a.substr(0,t)).lastIndexOf(" ");return-1!=n&&(a=a.substr(0,n)),a+(i||" …")}});